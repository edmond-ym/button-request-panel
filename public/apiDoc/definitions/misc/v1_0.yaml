openapi: 3.0.0
servers:
  #- url: https://143.198.74.202
  #  description: Button Request Server
  - url: http://localhost
    description: Button Request Server
info:
  title: Button Request
  version: 1.0.0
  license: 
    name: Apache 2.0
    url: 'http://www.apache.org/licenses/LICENSE-2.0.html'
    #identifier: Apache 2.0

  description: >
    # Introduction
    
    Button Request is a platform for someone who want to replace tedious and repeated message with 
    a button. 
    
    ## API Categories

    There are only 2 classification of API
   
    Below is the API classification
    
      - Button Device API
      - Normal API

    ## API Operations

    ### Button Device API
    
    Generating Messages

    ### Normal API
    
    Managing Resources
    
   


tags:
  - name: deviceAPI
    description: Button Device API
    x-displayName: Button Device 

  - name: MessageAPI
    description: Fetch/Pin/Unpin/Delete Message through Normal API
    x-displayName: Message 

  - name: DeviceList
    description: Manage Device
    x-displayName: Device Management

  - name: DeviceShare
    description: Device Share
    x-displayName: Device Share

  - name: MobileAccessToken
    description: Mobile Access Token
    x-displayName: Mobile Access Token


paths:
  '/deviceAPI/v1/{deviceId}':
    post:
      security:
        - DeviceAPIAuth: []    
      tags:
        - deviceAPI
      description: Send a Button Request
      summary: Send a message by pressing the button
      operationId: deviceAPI
      parameters:
          - name: deviceId
            in: path
            required: true
            deprecated: false
            schema:
              type: string
            
          - name: button_id
            in: query
            required: true
            deprecated: false
            schema:
              type: string
                  

      responses:
        'default':
          description: successful operation
          content:
            application/json:
              schema:
                type: object
                properties:
                  result: 
                    description: Result of the Action
                    type: string
                    example: success
                    enum: 
                      - not-valid-request
                      - device-id-not-exist
                      - decryption-failed
                      - no-privilege
                      - not-subscribed
                      - fail
                      - success
                      - no-repeated-message
                      - button-id-not-exist
                      - no-repeated-message
        '400':
          description: successful operation
          content:
            application/json:
              schema:
                type: object
                properties:
                  result: 
                    description: Result of the Action
                    type: string
                    example: success
                    enum: 
                      - not-valid-request
                     
       
  '/api/v1/message/fetch':   
    post:
      
      security:
        - NormalAPIAuth: []    
      tags:
        - MessageAPI
      description: Fetch all messages
      summary: Fetch all messages
      operationId: fetchMessage
      responses:
        'default':
          description: successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MessageFetchResult'
        '403':
          $ref: '#/components/responses/Unauthenticated'
          
  '/api/v1/message/pinStatus/{msgId}/{action}': 
    post:
      security:
        - NormalAPIAuth: []    
      tags:
        - MessageAPI
      description: Pin or Unpin Message
      summary: Pin or Unpin Message
      operationId: PinOrUnpinMessage
      parameters:

          - name: msgId
            in: path
            required: true
            deprecated: false
            schema:
              type: string
          - name: action
            in: path
            required: true
            deprecated: false
            schema:
              type: string
              enum:
                - pin
                - unpin

      responses:
        'default':
          description: successful operation
          content:
            application/json:
              schema:
                type: object
                properties:
                  result: 
                    description: Result of the Action
                    type: string
                    example: success
                    enum:
                      - success
                      - fail
                      - not-exist
                      - invalid-action
                      - not-subscribed
                      - no-privilege
        '403':
          $ref: '#/components/responses/Unauthenticated'
  
  '/api/v1/message/delete/{msgId}':    
    post:
      security:
        - NormalAPIAuth: []    
      tags:
        - MessageAPI
      description: Delete Message
      summary: Delete Message
      operationId: deleteMessage
      parameters:

          - name: msgId
            in: path
            required: true
            deprecated: false
            schema:
              type: string
      responses:
        'default':
          description: successful operation
          content:
            application/json:
              schema:
                type: object
                properties:
                  result: 
                    description: Result of the Action
                    type: string
                    example: success
                    enum:
                      - success
                      - fail
                      - not-exist
                      - not-subscribed
                      - no-privilege
        '403':
          $ref: '#/components/responses/Unauthenticated'
  

  '/api/v1/buttonDevice/myDevice/list/{device_id}': 
    post:
      security:
        - NormalAPIAuth: []    
      tags:
        - DeviceList
      description: Fetch Device List
      summary: Fetch Device List
      operationId: fetchDeviceList
      parameters:

          - name: device_id
            in: path
            required: false
            deprecated: false
            schema:
              type: string

      responses:
        'default':
          description: successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DeviceListFetchResult'
        '403':
          $ref: '#/components/responses/Unauthenticated'

  '/api/v1/buttonDevice/myDevice/repeatedMessage/{device_id}/{action}': 
    post:
      security:
        - NormalAPIAuth: []    
      tags:
        - DeviceList
      description: Repeated Message Settings
      summary: Repeated Message Settings

      operationId: repeatedMessageSettings
      parameters:
          - name: device_id
            in: path
            required: true
            deprecated: false
            schema:
              type: string
          - name: action
            in: path
            required: true
            deprecated: false
            schema:
              type: string
              enum:
                - allow
                - disallow
     

      responses:
        'default':
          description: successful operation
          content:
            application/json:
              schema:

                type: object
                properties:
                  result: 
                    description: Result of the Action
                    type: string
                    example: success
                    enum: 
                      - no-privilege
                      - not-subscribed
                      - invalid-command
                      - fail
                      - success
                  data:
                    description: Data
                    ##type: array
                    items:
                      properties:
                        device_id:
                          type: string
                        info: 
                          type: string
                        datetime: 
                          type: string
                        status: 
                          type: string
                          enum:
                            - active
                            - suspend
                        nickname:
                          type: string
                        repeated_message: 
                          #type: string
                          enum: 
                            - null
                            - no
        '403':
          $ref: '#/components/responses/Unauthenticated'
            
  '/api/v1/buttonDevice/myDevice/buttonMessageUpdate/updateOrNew/{device_id}': 
    post:
      security:
        - NormalAPIAuth: []    
      tags:
        - DeviceList
      description: Button Message Update
      summary: Button Message Update

      operationId: buttonMessageUpdate
      parameters:
          - name: device_id
            in: path
            required: true
            deprecated: false
            schema:
              type: string
              
          
      requestBody:
        description: Button Message Info
        required: true
        content:
          application/x-www-form-urlencoded:
            schema:
              type: object
              properties:
                passData: 
                  type: object
                  properties:
                    dataArray: 
                      type: array
                      items:
                        required:
                        - buttonNo
                        - message
                        properties:
                         buttonNo:
                           type: string
                           default: ''
                           example:
                           - ewq
                         message:
                           title: Message
                           type: string
                           default: ''
                           example:
                           - ewq1
 
      responses:
        'default':
          description: successful operation
          content:
            application/json:
              schema:
                type: object
                properties:
                  result: 
                    description: Result of the Action
                    type: string
                    example: success
                    enum:
                      - no-privilege
                      - not-subscribed
                      - passData-body-key-missing
                      - dataArray-key-missing
                      - invalid-command
                      - not-valid-array
                      - fail
                      - success
                  data:
                    description: Data
                    ##type: array
                    items:
                      properties:
                        device_id:
                          type: string
                        info: 
                          type: string
                        datetime: 
                          type: string
                        status: 
                          type: string
                          enum:
                            - active
                            - suspend
                        nickname:
                          type: string
                        repeated_message: 
                          #type: string
                          enum: 
                            - null
                            - no
        '403':
          $ref: '#/components/responses/Unauthenticated'        
  '/api/v1/buttonDevice/myDevice/buttonMessageUpdate/delete/{device_id}': 
    post:
      security:
        - NormalAPIAuth: []    
      tags:
        - DeviceList
      description: Button Message Delete
      summary: Button Message Delete

      operationId: buttonMessageDelete
      parameters:
          - name: device_id
            in: path
            required: true
            deprecated: false
            schema:
              type: string
      requestBody:
        description: Delete Button Id
        required: true
        content:
          application/form-data:
            schema:
              type: object
              properties:
                passData: 
                  type: object
                  properties:
                    dataArray: 
                      type: array
                      items:
                        type: "string"
                    
              
      responses:
        'default':
          description: successful operation
          content:
            application/json:
              schema:
                type: object
                properties:
                  result: 
                    description: Result of the Action
                    type: string
                    example: success
                    enum:
                      - no-privilege
                      - not-subscribed
                      - passData-body-key-missing
                      - dataArray-key-missing
                      - invalid-command
                      - not-valid-array
                      - fail
                      - success
                  data:
                    description: Data
                    ##type: array
                    items:
                      properties:
                        device_id:
                          type: string
                        info: 
                          type: string
                        datetime: 
                          type: string
                        
                        status: 
                          type: string
                          enum:
                            - active
                            - suspend
                        nickname:
                          type: string
                        repeated_message: 
                          #type: string
                          enum: 
                            - null
                            - no
        '403':
          $ref: '#/components/responses/Unauthenticated'
  '/api/v1/buttonDevice/deviceSharedToMe/fetch': 
    post:
      security:
        - NormalAPIAuth: []    
      tags:
        - DeviceShare
      description: Fetch Device Shared To Me
      summary: Fetch Device Shared To Me

      operationId: fetchDeviceSharedToMe
      responses:
        'default':
          description: successful operation
          content:
            application/json:
              schema:
                type: array
                items:
                  properties:
                    result: 
                      description: Result of the Action
                      type: string
                      example: success
                      enum:
                        - success
                        - not-subscribed
                        - no-privilege

                    data:
                      description: Device Data
                      type: array
                      items: 
                        properties:
                          case_id: 
                            type: string
                          device_id:
                            type: string
                          share_to_user_id:
                            type: string
                          created_time: 
                            type: string
                          nickname:
                            type: string
                          status: 
                            type: string
                            enum: 
                              - active
                              - suspend
                          info: 
                            type: string
                          right:
                            type: string
                            enum:
                              - basic
                              - middle
                              - advanced
                          owner_name:
                            type: string
                          owner_email: 
                            type: string
        '403':
          $ref: '#/components/responses/Unauthenticated'   

  '/api/v1/buttonDevice/deviceSharedToMe/delete/{case_id}': 
    post:
      security:
        - NormalAPIAuth: []    
      tags:
        - DeviceShare
      description: Give up Sharee's Right
      summary: Give up Sharee's Right

      operationId: giveUpShareeRight
      parameters:
          - name: case_id
            in: path
            required: true
            deprecated: false
            schema:
              type: string
         
      responses:
        'default':
          description: successful operation
          content:
            application/json:
              schema:
                ##$ref: '#/components/schemas/Result'
                type: object
                properties:
                  result: 
                    description: Result of the Action
                    type: string
                    example: success
                    enum: 
                      - no-privilege
                      - not-subscribed
                      - fail
                      - success
                  data:
                    description: Data
                    ##type: array
                    properties:
                      case_id:
                        type: string
        '403':
          $ref: '#/components/responses/Unauthenticated'              
  
  '/api/v1/buttonDevice/shareDevice/new/{email}/{device_id}': 
    post:
      security:
        - NormalAPIAuth: []    
      tags:
        - DeviceShare
      description: Share Device To
      summary: Share Device to another user

      operationId: shareDeviceTo
      parameters:
          - name: device_id
            in: path
            required: true
            deprecated: false
            schema:
              type: string
          - name: email
            in: path
            required: true
            deprecated: false
            schema:
              type: string
         
      responses:
        'default':
          description: successful operation
          content:
            application/json:
              schema:
                type: object
                properties:
                  result: 
                    description: Result of the Action
                    type: string
                    example: success
                    enum: 
                      - no-privilege
                      - not-subscribed
                      - not-valid-email
                      - fail
                      - success
                  data:
                    description: Data
                    ##type: array
                    items:
                      properties:
                        name: 
                          type: string
                        email: 
                          type: string
                        right: 
                          type: string
                          enum:
                              - basic
                              - middle
                              - advanced
                        device_id: 
                          type: string
                        case_id: 
                          type: string
                        created_time: 
                          type: string
        '403':
          $ref: '#/components/responses/Unauthenticated'
                        
                         

  '/api/v1/buttonDevice/shareDevice/changeRight/{case_id}/{right}': 
    post:
      security:
        - NormalAPIAuth: []    
      tags:
        - DeviceShare
      description: Change Sharee's Right
      summary: Change Sharee's Right

      operationId: changeShareeRight
      parameters:
          - name: case_id
            in: path
            required: true
            deprecated: false
            schema:
              type: string
          - name: right
            in: path
            required: true
            deprecated: false
            schema:
              type: string
              enum:
                - basic
                - middle
                - advanced
      responses:
        'default':
          description: successful operation
          content:
            application/json:
              schema:
                type: object
                properties:
                  result: 
                    description: Result of the Action
                    type: string
                    example: success
                    enum:
                      - no-privilege
                      - not-subscribed
                      - not-valid-right
                      - case-id-not-exist
                      - fail
                      - success
                  data:
                    description: Data
                    ##type: array
                    items:
                      properties:
                        name: 
                          type: string
                        email: 
                          type: string
                        right: 
                          type: string
                          enum:
                            - basic
                            - middle
                            - advanced
                        device_id: 
                          type: string
                        case_id: 
                          type: string
                        created_time: 
                          type: string
        '403':
          $ref: '#/components/responses/Unauthenticated'                  


  '/api/v1/buttonDevice/myDevice/new/{nickname}': 
    post:
      security:
        - NormalAPIAuth: []    
      tags:
        - DeviceList
      description: New Device
      summary: Add New Device

      operationId: newDevice
      parameters:
          - name: nickname
            in: path
            required: true
            deprecated: false
            schema:
              type: string
          
      responses:
        'default':
          description: successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NewDevice'
        '403':
          $ref: '#/components/responses/Unauthenticated'

  '/api/v1/mobileDevice/fetch': 
    post:
      security:
        - NormalAPIAuth: []    
      tags:
        - MobileAccessToken
      description: Fetch Mobile Access Token
      summary: Fetch Mobile Access Token

      operationId: fetchMobileAccessToken
      responses:
        'default':
          description: successful operation
          content:
            application/json:
              schema:
                type: object
                properties:
                  result: 
                    description: Result of the Action
                    type: string
                    example: success
                    enum:
                      - success
                      - not-subscribed
                      - no-privilege
                  data:
                    description: Data
                    ##type: array
                    items:
                      properties:
                        case_id: 
                          type: string
                        nickname:
                          type: string
                        access_token:
                          type: string
                        deleted_from_phone:
                          type: string
                        last_access:
                          type: string
        '403':
          $ref: '#/components/responses/Unauthenticated'        

  '/api/v1/mobileDevice/new/{nickname}': 
    post:
      security:
        - NormalAPIAuth: []    
      tags:
        - MobileAccessToken
      description: New Mobile Access Token
      summary: New Mobile Access Token

      operationId: newMobileAccessToken
      parameters:
          - name: nickname
            in: path
            required: true
            deprecated: false
            schema:
              type: string
          
      responses:
        'default':
          description: successful operation
          content:
            application/json:
              schema:
                type: object
                properties:
                  result: 
                    description: Result of the Action
                    type: string
                    example: success
                    enum:
                      - no-privilege
                      - not-subscribed
                      - fail
                      - success
                  data:
                    description: Data
                    ##type: array
                    items:
                      properties:
                        case_id: 
                          type: string
                        nickname:
                          type: string
                        access_token:
                          type: string
                        deleted_from_phone:
                          type: string
                        last_access:
                          type: string
        '403':
          $ref: '#/components/responses/Unauthenticated'     
  
  '/api/v1/mobileDevice/amend/{case_id}': 
    post:
      security:
        - NormalAPIAuth: []    
      tags:
        - MobileAccessToken
      description: Amend Nickname
      summary: Amend Nickname 

      operationId: amendMobileAccessTokenNickname
      parameters:
          - name: case_id
            in: path
            required: true
            deprecated: false
            schema:
              type: string
          - name: nickname
            in: query
            required: true
            deprecated: false
            schema:
              type: string
          
      responses:
        'default':
          description: successful operation
          content:
            application/json:
              schema: 
                type: object
                properties:
                  result: 
                    description: Result of the Action
                    type: string
                    example: success
                    enum:
                      - no-privilege
                      - not-subscribed
                      - fail
                      - success
                      - invalid-query
                  data:
                    description: Data
                    ##type: array
                    items:
                      properties:
                        case_id: 
                          type: string
                        nickname:
                          type: string
                        access_token:
                          type: string
                        deleted_from_phone:
                          type: string
                        last_access:
                          type: string
        '403':
          $ref: '#/components/responses/Unauthenticated'
  '/api/v1/mobileDevice/revoke/{case_id}': 
    post:
      security:
        - NormalAPIAuth: []    
      tags:
        - MobileAccessToken
      description: Revoke Access Token
      summary: Revoke Access Token

      operationId: revokeMobileAccessToken
      parameters:
          - name: case_id
            in: path
            required: true
            deprecated: false
            schema:
              type: string

      responses:
        'default':
          description: successful operation
          content:
            application/json:
              schema:
                type: object
                properties:
                  result: 
                    description: Result of the Action
                    type: string
                    example: success
                    enum:
                      - no-privilege
                      - not-subscribed
                      - fail
                      - success
                  data:
                    description: Data
                    ##type: array
                    
                    properties:
                      case_id: 
                        type: string
        '403':
          $ref: '#/components/responses/Unauthenticated'                
   

components:
  securitySchemes:
    DeviceAPIAuth:
      description: This is for the Button Device Request
      type: http
      scheme: bearer
      bearerFormat: JWT 
    NormalAPIAuth:
      description: This is normal API
      type: http
      scheme: bearer
                
  responses:
    Unauthenticated:
      description: Unauthenticated
      content:
        application/json:
          schema:
            type: object
            properties:
              result:
                type: string
                enum: 
                  - not-authenticated
          
  schemas:
    
  
    #ResultCommon:
    #  type: string
    #  #properties:
    #  enum:
    #    - success
    #    - not-subscribed
    #    - no-privilege
    #Result:
    #  type: object
    #  properties:
    #    result: 
    #      description: Result of the Action
    #      type: string
    #      example: success
    #      
    MessageFetchResult:
      type: object
      properties:
        result: 
          description: Result of the Action
          type: string
          example: success
          enum:
          
            - success
            - not-subscribed
            - no-privilege
        data:
          description: Data
          ##type: array
          items:
            ##$ref:  '#/components/schemas/MessageFetchData'
            properties:
              msg_id: 
                type: string
              message: 
                type: string
              datetime: 
                type: string
              device_id: 
                type: string
              nickname: 
                type: string
              pin:
                type: boolean
                enum:
                  - true
                  - false
              shared_to_me: 
                type: boolean
                enum:
                  - true
                  - false
            example:
              msg_id: rKApwQgjdSxFn4MdpOhMUA4I3X3dRy84B7CUMirm
              message: Hi
              datetime: 2022-03-06 21:10:31 +00:00
              device_id: d0d2b049-bc71-4606-8492-3521f76beb8e
              nickname: Device 1
              pin": false
              shared_to_me: false
    DeviceListFetchResult:
      type: object
      properties:
        result: 
          description: Result of the Action
          type: string
          example: success
          enum:
            - success
            - not-subscribed
            - no-privilege
        data:
          description: Device List Fetched
          type: array
          items:
            properties:
              device_id:
                type: string
              info: 
                type: string
              datetime: 
                type: string
              status: 
                type: string
                enum: 
                  - active
                  - suspend
              nickname:
                type: string
              repeated_message: 
                #type: string
                enum: 
                  - null
                  - no

              OwnershipShare: 
                type: object
                items:
                  properties:
                    case_id:
                      type: string
                    name:
                      type: string
                    email:
                      type: string
                    right:
                      type: string
                    created_time:
                      type: string

            ###example: 
            ###  - device_id: 65c35959-d54c-46c5-a388-26d073928d4f
            ###    info: []
            ###    datetime: 2022-03-08 20:21:39 +00:00
            ###    status: active
            ###    nickname: Device 1
            ###    repeated_message: no
            ###    OwnershipShare: 
            ###        name: Someone
            ###        email: someone@example.com
            ###        right: basic
            ###        created_time: 2022-03-24 08:47:39 +00:00
                  
                   
                    
   
      
            ###example:
            ###  device_id: 65c35959-d54c-46c5-a388-26d073928d4f
            ###  info: []
            ###  datetime: 2022-03-08 20:21:39 +00:00
            ###  status: active
            ###  nickname: Device 1
            ###  repeated_message: no
              
    NewDevice:
      type: object
      properties:
        result: 
          description: Result of the Action
          type: string
          example: success
          enum: 
            - no-privilege
            - not-subscribed
            - missing-nickname
            - success
            - fail
        data:
          description: Data
          ##type: array
          items:
            properties:
              case_id:
                type: string
              device_id:
                type: string
              user_id:
                type: string
              bearer_token:  
                type: string
              info:
                type: string
              datetime: 
                type: string
              
              status: 
                type: string
                enum:
                  - active
                  - suspend
              nickname:
                type: string
             
    
    
   



            
           
      



      




            
    

          



            
    

          


