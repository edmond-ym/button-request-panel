openapi: 3.0.0
servers:
  ##- url: https://143.198.74.202
  ##  description: Button Device Server
  - url: http://localhost
    description: Button Device Server
info:
  title: Button Request
  version: 1.0.0
  description: >
    # Introduction
    
    Button Request is a platform for someone who want to replace tedious and repeated message with 
    a button. 
    
    ## API Categories

    There are only 1 category of API
   
    Below is the API classification
    
      - Button Device API

    ## API Operations

    ### Button Device API
    
    Using the Button Device API, you may send the defined messages to the console.

   

    # Authentication
  
    ##For Button Device API, the device id and the bearer token is the authentication method 



tags:
  - name: deviceAPI
    description: Button Device API
  - name: MessageAPI
    description: Fetch/Pin/Unpin/Delete Message through Normal API
  - name: DeviceList
    description: Manage Device
  - name: DeviceShare
    description: Device Share
  - name: MobileAccessToken
    description: Mobile Access Token
paths:
  '/deviceAPI/v1/{deviceId}':
    post:
      security:
        - DeviceAPIAuth: []    
      tags:
        - deviceAPI
      description: Send a Button Request
      parameters:
          - name: deviceId
            in: path
            required: true
            deprecated: false
            schema:
              type: string
            
          - name: button_id
            in: query
            required: true
            deprecated: false
            schema:
              type: string
                  

      responses:
        'default':
          description: successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Result'
  '/api/v1/message/fetch':   
    post:
      security:
        - NormalAPIAuth: []    
      tags:
        - MessageAPI
      description: Fetch all messages
      
      responses:
        'default':
          description: successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MessageFetchResult'

  '/api/v1/message/pinStatus/{msgId}/{action}': 
    post:
      security:
        - NormalAPIAuth: []    
      tags:
        - MessageAPI
      description: Pin or Unpin Message
      parameters:

          - name: msgId
            in: path
            required: true
            deprecated: false
            schema:
              type: string
          - name: action
            in: path
            required: true
            deprecated: false
            schema:
              type: string
              enum:
                - pin
                - unpin

      responses:
        'default':
          description: successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Result'
  
  '/api/v1/message/delete/{msgId}':    
    post:
      security:
        - NormalAPIAuth: []    
      tags:
        - MessageAPI
      description: Delete Message
      parameters:

          - name: msgId
            in: path
            required: true
            deprecated: false
            schema:
              type: string
      responses:
        'default':
          description: successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Result'

  '/api/v1/buttonDevice/myDevice/list/{device_id}': 
    post:
      security:
        - NormalAPIAuth: []    
      tags:
        - DeviceList
      description: Fetch Device List
      parameters:

          - name: device_id
            in: path
            required: true
            deprecated: false
            schema:
              type: string

      responses:
        'default':
          description: successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DeviceListFetchResult'

  '/api/v1/buttonDevice/myDevice/repeatedMessage/{device_id}/{action}': 
    post:
      security:
        - NormalAPIAuth: []    
      tags:
        - DeviceList
      description: Repeated Message Settings
      parameters:
          - name: device_id
            in: path
            required: true
            deprecated: false
            schema:
              type: string
          - name: action
            in: path
            required: true
            deprecated: false
            schema:
              type: string
              enum:
                - allow
                - disallow
     

      responses:
        'default':
          description: successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DeviceListRepeatedMessage'

  '/api/v1/buttonDevice/myDevice/buttonMessageUpdate/updateOrNew/{device_id}': 
    post:
      security:
        - NormalAPIAuth: []    
      tags:
        - DeviceList
      description: Button Message Update
      parameters:
          - name: device_id
            in: path
            required: true
            deprecated: false
            schema:
              type: string
          
      requestBody:
        description: Button Message Info
        required: true
        content:
          application/x-www-form-urlencoded:
            schema:
              type: object
              properties:
                passData: 
                  type: object
                  properties:
                    dataArray: 
                      type: array
                      items:
                        required:
                        - buttonNo
                        - message
                        properties:
                         buttonNo:
                           type: string
                           default: ''
                           examples:
                           - ewq
                         message:
                           title: Message
                           type: string
                           default: ''
                           examples:
                           - ewq1
 
      responses:
        'default':
          description: successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DeviceListRepeatedMessage'
                
  '/api/v1/buttonDevice/myDevice/buttonMessageUpdate/delete/{device_id}': 
    post:
      security:
        - NormalAPIAuth: []    
      tags:
        - DeviceList
      description: Button Message Delete
      parameters:
          - name: device_id
            in: path
            required: true
            deprecated: false
            schema:
              type: string
      requestBody:
        description: Delete Button Id
        required: true
        content:
          application/form-data:
            schema:
              type: object
              properties:
                passData: 
                  type: object
                  properties:
                    dataArray: 
                      type: array
                      items:
                        type: "string"
                    
              
      responses:
        'default':
          description: successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DeviceListRepeatedMessage'
  
  '/api/v1/buttonDevice/deviceSharedToMe/fetch': 
    post:
      security:
        - NormalAPIAuth: []    
      tags:
        - DeviceShare
      description: Fetch Device Shared To Me
      responses:
        'default':
          description: successful operation
          content:
            application/json:
              schema:
                type: array
                items:
                  properties:
                    result: 
                      description: Result of the Action
                      type: string
                      example: success
                    data:
                      type: array
                      items: 
                        properties:
                          case_id: 
                            type: string
                          device_id:
                            type: string
                          share_to_user_id:
                            type: string
                          created_time: 
                            type: string
                          nickname:
                            type: string
                          status: 
                            type: string
                          info: 
                            type: string
                          right:
                            type: string
                          owner_name:
                            type: string
                          owner_email: 
                            type: string
                                 
  '/api/v1/buttonDevice/deviceSharedToMe/delete/{case_id}': 
    post:
      security:
        - NormalAPIAuth: []    
      tags:
        - DeviceShare
      description: Give up Sharee Right
      parameters:
          - name: case_id
            in: path
            required: true
            deprecated: false
            schema:
              type: string
         
      responses:
        'default':
          description: successful operation
          content:
            application/json:
              schema:
                ##$ref: '#/components/schemas/Result'
                type: object
                properties:
                  result: 
                    description: Result of the Action
                    type: string
                    example: success
                  data:
                    description: Data
                    ##type: array
                    properties:
                      case_id":
                        type: string
                      
  
  '/api/v1/buttonDevice/shareDevice/new/{email}/{device_id}': 
    post:
      security:
        - NormalAPIAuth: []    
      tags:
        - DeviceShare
      description: Share Device To
      parameters:
          - name: device_id
            in: path
            required: true
            deprecated: false
            schema:
              type: string
          - name: email
            in: path
            required: true
            deprecated: false
            schema:
              type: string
         
      responses:
        'default':
          description: successful operation
          content:
            application/json:
              schema:
                type: object
                properties:
                  result: 
                    description: Result of the Action
                    type: string
                    example: success
                  data:
                    description: Data
                    ##type: array
                    items:
                      properties:
                        name: 
                          type: string
                        email: 
                          type: string
                        right: 
                          type: string
                        device_id: 
                          type: string
                        case_id: 
                          type: string
                        created_time: 
                          type: string

  '/api/v1/buttonDevice/shareDevice/changeRight/{case_id}/{right}': 
    post:
      security:
        - NormalAPIAuth: []    
      tags:
        - DeviceShare
      description: Change Sharee Right
      parameters:
          - name: case_id
            in: path
            required: true
            deprecated: false
            schema:
              type: string
          - name: right
            in: path
            required: true
            deprecated: false
            schema:
              type: string
              enum:
                - basic
                - middle
                - advanced
      responses:
        'default':
          description: successful operation
          content:
            application/json:
              schema:
                type: object
                properties:
                  result: 
                    description: Result of the Action
                    type: string
                    example: success
                  data:
                    description: Data
                    ##type: array
                    items:
                      properties:
                        name: 
                          type: string
                        email: 
                          type: string
                        right: 
                          type: string
                        device_id: 
                          type: string
                        case_id: 
                          type: string
                        created_time: 
                          type: string
                          


  '/api/v1/buttonDevice/myDevice/new/{nickname}': 
    post:
      security:
        - NormalAPIAuth: []    
      tags:
        - DeviceList
      description: New Device
      parameters:
          - name: nickname
            in: path
            required: true
            deprecated: false
            schema:
              type: string
          
      responses:
        'default':
          description: successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NewDevice'

  '/api/v1/mobileDevice/fetch': 
    post:
      security:
        - NormalAPIAuth: []    
      tags:
        - MobileAccessToken
      description: Fetch Mobile Access Token
          
      responses:
        'default':
          description: successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MobileAccessTokenRelated'
                

  '/api/v1/mobileDevice/new/{nickname}': 
    post:
      security:
        - NormalAPIAuth: []    
      tags:
        - MobileAccessToken
      description: New Mobile Access Token
      parameters:
          - name: nickname
            in: path
            required: true
            deprecated: false
            schema:
              type: string
          
      responses:
        'default':
          description: successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MobileAccessTokenRelated'
   
  
  '/api/v1/mobileDevice/amend/{case_id}': 
    post:
      security:
        - NormalAPIAuth: []    
      tags:
        - MobileAccessToken
      description: Amend Nickname
      parameters:
          - name: case_id
            in: path
            required: true
            deprecated: false
            schema:
              type: string
          - name: nickname
            in: query
            required: true
            deprecated: false
            schema:
              type: string
          
      responses:
        'default':
          description: successful operation
          content:
            application/json:
              schema: 
                $ref: '#/components/schemas/MobileAccessTokenRelated'

  '/api/v1/mobileDevice/revoke/{case_id}': 
    post:
      security:
        - NormalAPIAuth: []    
      tags:
        - MobileAccessToken
      description: Revoke Access Token
      parameters:
          - name: case_id
            in: path
            required: true
            deprecated: false
            schema:
              type: string

      responses:
        'default':
          description: successful operation
          content:
            application/json:
              schema:
                type: object
                properties:
                  result: 
                    description: Result of the Action
                    type: string
                    example: success
                  data:
                    description: Data
                    ##type: array
                    
                    properties:
                      case_id: 
                        type: string
                        
   

components:
  securitySchemes:
    DeviceAPIAuth:
      description: This is for the Button Device Request
      type: http
      scheme: bearer
      bearerFormat: JWT 
    NormalAPIAuth:
      description: This is normal API
      type: http
      scheme: bearer
      
  schemas:
    Result:
      type: object
      properties:
        result: 
          description: Result of the Action
          type: string
          example: success
    MessageFetchResult:
      type: object
      properties:
        result: 
          description: Result of the Action
          type: string
          example: success
        data:
          description: Data
          ##type: array
          items:
            ##$ref:  '#/components/schemas/MessageFetchData'
            properties:
              msg_id: 
                type: string
              message: 
                type: string
              datetime: 
                type: string
              device_id: 
                type: string
              nickname: 
                type: string
              pin:
                type: boolean
              shared_to_me: 
                type: boolean
            example:
              msg_id: rKApwQgjdSxFn4MdpOhMUA4I3X3dRy84B7CUMirm
              message: Hi
              datetime: 2022-03-06 21:10:31 +00:00
              device_id: d0d2b049-bc71-4606-8492-3521f76beb8e
              nickname: Device 1
              pin": false
              shared_to_me: false
    DeviceListFetchResult:
      type: object
      properties:
        result: 
          description: Result of the Action
          type: string
          example: success
        data:
          description: Data
          type: array
          items:
            properties:
              device_id:
                type: string
              info: 
                type: string
              datetime: 
                type: string
              status: 
                type: string
              nickname:
                type: string
              repeated_message: 
                type: string

              OwnershipShare: 
                type: object
                items:
                  properties:
                    case_id:
                      type: string
                    name:
                      type: string
                    email:
                      type: string
                    right:
                      type: string
                    created_time:
                      type: string

            ###example: 
            ###  - device_id: 65c35959-d54c-46c5-a388-26d073928d4f
            ###    info: []
            ###    datetime: 2022-03-08 20:21:39 +00:00
            ###    status: active
            ###    nickname: Device 1
            ###    repeated_message: no
            ###    OwnershipShare: 
            ###        name: Someone
            ###        email: someone@example.com
            ###        right: basic
            ###        created_time: 2022-03-24 08:47:39 +00:00
                  
                   
                    
    DeviceListRepeatedMessage:
      type: object
      properties:
        result: 
          description: Result of the Action
          type: string
          example: success
        data:
          description: Data
          ##type: array
          items:
            properties:
              device_id:
                type: string
              info: 
                type: string
              datetime: 
                type: string
              status: 
                type: string
              nickname:
                type: string
              repeated_message: 
                type: string

            ###example:
            ###  device_id: 65c35959-d54c-46c5-a388-26d073928d4f
            ###  info: []
            ###  datetime: 2022-03-08 20:21:39 +00:00
            ###  status: active
            ###  nickname: Device 1
            ###  repeated_message: no
              
    NewDevice:
      type: object
      properties:
        result: 
          description: Result of the Action
          type: string
          example: success
        data:
          description: Data
          ##type: array
          items:
            properties:
              case_id":
                type: string
              device_id":
                type: string
              user_id":
                type: string
              bearer_token":  
                type: string
              info":
                type: string
              datetime": 
                type: string
              status": 
                type: string
              nickname": 
                type: string

    MobileAccessTokenRelated:
      type: object
      properties:
        result: 
          description: Result of the Action
          type: string
          example: success
        data:
          description: Data
          ##type: array
          items:
            properties:
              
              case_id: 
                type: string
              nickname:
                type: string
              access_token:
                type: string
              deleted_from_phone:
                type: string
              last_access:
                type: string
   



            
           
      



      




            
    

          


